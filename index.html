<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Survey</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
        .container { max-width: 800px; margin: 20px auto; padding: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Survey</h1>
        <div id="typeform-container"></div>
        <script>
            console.log("JavaScript is running");  // Check if this message appears

            const questionTimes = {
                q1start: 0,
                q1end: 0,
                q2start: 0,
                q2end: 0,
                q3start: 0,
                q3end: 0
            };

            function updateQuestionTime(question, type) {
                questionTimes[`${question}${type}`] = Date.now();
                updateTypeformURL();
            }

            function updateTypeformURL() {
                const typeformUrl = new URL('https://pmm3ah6z9pr.typeform.com/to/GwZg02zN');
                typeformUrl.searchParams.set('q1start', questionTimes.q1start);
                typeformUrl.searchParams.set('q1end', questionTimes.q1end);
                typeformUrl.searchParams.set('q2start', questionTimes.q2start);
                typeformUrl.searchParams.set('q2end', questionTimes.q2end);
                typeformUrl.searchParams.set('q3start', questionTimes.q3start);
                typeformUrl.searchParams.set('q3end', questionTimes.q3end);

                console.log("Updated Typeform URL:", typeformUrl.href);  // Check URL

                const container = document.getElementById('typeform-container');
                if (container) {
                    container.innerHTML = `
                        <div class="typeform-widget" data-url="${typeformUrl.href}" style="width: 100%; height: 500px;"></div>
                        <script> (function() { var qs,js,q,s,d=document, gi=d.getElementById, ce=d.createElement, gt=d.getElementsByTagName, id="typef_orm", b="https://embed.typeform.com/"; if(!gi.call(d,id)) { js=ce.call(d,"script"); js.id=id; js.src=b+"embed.js"; q=gt.call(d,"script")[0]; q.parentNode.insertBefore(js,q) } })() <\/script>
                    `;
                } else {
                    console.error('Typeform container element not found');
                }
            }

            // Test with static timestamps for debugging
            updateQuestionTime('q1', 'start');
            updateQuestionTime('q1', 'end');
        </script>
    </div>
</body>
</html>
